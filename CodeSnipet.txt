====How to remove all the spaces and \n\r in a String?
let text = "This \n is a st\tri\rng"
let test = String(text.filter { !" \n\t\r".contains($0) })

- lấy đường dẫn file (sử dụng RealmSwift)
	print("Duong dan file: \(Realm.Configuration.defaultConfiguration.fileURL)")

- lấy full link trong alamofire

extension Request {
    public func debugLog() -> Self {
        #if DEBUG
            debugPrint("====")
            debugPrint(self)
            debugPrint("====")
        #endif
        return self
    }
}

// gọi ra

  Alamofire.request(url).debugLog()
            .responseJSON( completionHandler: { response in
   })

- Remove ký tự bất kỳ trong chuỗi String
        var phrase = """
		Any long charactor
	"""
        let vowels: Set<Character> = ["\\", "[", "]"]
        phrase.removeAll(where: { vowels.contains($0) })
- Action trong alert
	        let alert = UIAlertController(title: "Thông báo".language(), message: "Bạn chắc chắn xoá", preferredStyle: .alert)
                alert.addAction(UIAlertAction(title: "KHÔNG".language(), style: .default, handler: nil))
                
                alert.addAction(UIAlertAction(title: "CÓ".language(), style: .default, handler: { (alertAction) in
                    // do something
                }))
                self.present(alert, animated: true, completion: nil)


Downlload ảnh:
	import UIKit

extension UIImageView {
    func dowloadFromServer(url: URL, contentMode mode: UIView.ContentMode = .scaleAspectFit) {
        contentMode = mode
        URLSession.shared.dataTask(with: url) { data, response, error in
            guard
                let httpURLResponse = response as? HTTPURLResponse, httpURLResponse.statusCode == 200,
                let mimeType = response?.mimeType, mimeType.hasPrefix("image"),
                let data = data, error == nil,
                let image = UIImage(data: data)
                else { return }
            DispatchQueue.main.async() {
                self.image = image
            }
            }.resume()
    }
    
    func dowloadFromServer(link: String, contentMode mode: UIView.ContentMode = .scaleAspectFit) {
        guard let url = URL(string: link) else { return }
        dowloadFromServer(url: url, contentMode: mode)
    }
}

sử dụng: ảnh. dowloadFromServer(link: String)
	 ảnh. dowloadFromServer(url: URL)


// mở rộng để add param cho url
extension URL {

func appendingParams(_ queryItem: String, value: String?) -> URL {

guard var urlComponents = URLComponents(string: absoluteString) else { return absoluteURL }

// Create array of existing query items
var queryItems: [URLQueryItem] = urlComponents.queryItems ??  []

// Create query item
let queryItem = URLQueryItem(name: queryItem, value: value)

// Append the new query item in the existing query items array
queryItems.append(queryItem)

// Append updated query items array in the url component object
urlComponents.queryItems = queryItems

// Returns the url from new url components
return urlComponents.url!
}
}

sử dụng
let url = URL(string: "https://www.thecocktaildb.com/api/json/v1/1/search.php")
let finalURL = url?.appendingParams("s", value: s)

BaseRouter.shared.callAPI(url: finalURL!) { (data: BaseDataModel) in
self.drinks = data.drinks
self.tableView.reloadData()
}


KẺ ĐƯỜNG LINE CẠNH CỦA BUTTON
let bottomLine = UIView(frame: CGRect(x: 0, y: connectLinkSubButton.bounds.height, width: connectLinkSubButton.bounds.width, height: 1))
        bottomLine.backgroundColor = UIColor.red
        connectLinkSubButton.addSubview(bottomLine)


VỊ TRÍ CỦA IMAGE IN BUTTON
dropdownButton.imageEdgeInsets = UIEdgeInsets(top: 0, left: dropdownButton.bounds.width - (dropdownButton.titleLabel?.bounds.width ?? 0), bottom: 0, right: 0)
dropdownButton.titleLabel?.bounds.width là tiêu đề button

Vị trí của ảnh so với chữ tiêu đề trong button (bên phải)
dropdownButton.semanticContentAttribute = UIApplication.shared
        .userInterfaceLayoutDirection == .rightToLeft ? .forceLeftToRight : .forceRightToLeft

====
// Hàm lọc. Dùng cho search và lọc append
filtered = data.filter { word in
            word.lowercased().contains(searchText.lowercased())
        }
filerred là mảng kết quả. data là mảng nguồn. (lọc mảng data append vào mảng filtered)



====
Ẩn bàn phím textField khi nhập xong
    @IBOutlet var text: UITextField! {
      didSet {
       text.delegate = self
      }
}

func textFieldShouldReturn(_ textField: UITextField) -> Bool {
    textField.resignFirstResponder()
    return true
}

//TextView
trong viewDidload() 
        textView.delegate = self
    

    /* Updated for Swift 4 */
    func textView(_ textView: UITextView, shouldChangeTextIn range: NSRange, replacementText text: String) -> Bool {
        if(text == "\n") {
            textView.resignFirstResponder()
            return false
        }
        return true
    }

    /* Older versions of Swift */
    func textView(textView: UITextView, shouldChangeTextInRange range: NSRange, replacementText text: String) -> Bool {
        if(text == "\n") {
            textView.resignFirstResponder()
            return false
        }
        return true
    }


====
Click button bàn phím thực hiện action
UISearchBarDelegate {
    func updateSearchResultsForSearchController(searchController: UISearchController) {
        if searchController.searchBar.text?.count ?? 0 < 15 {
            
        }

    }

func searchBarSearchButtonClicked(_ searchBar: UISearchBar) {
        view.endEditing(true)
    }

====
LỌC Tìm Kiếm:
Cách 1:
filteredArray = arrDicts.filter({word in
            word.lowercased().hasPrefix(keyword.lowercased())
        })

filteredArray là kết quả sau khi lọc mảng arrDicts với từ khoá là keyword

Cách 2:
func filtering() {
        resultArray = sourceArray.filter({ (laptop: String) in
            laptop.lowercased().contains(searchTextField.text!.lowercased())
        })
}

hàm này chạy để vừa search vừa hiển thị ra kết quả tìm kiếm
    func searchBar(_ searchBar: UISearchBar, textDidChange searchText: String) {
    }

====
Lưu ý khi thực hiện xong bài này. Nhập xong với lọc và vừa nhập vừa lọc ra kết quả. Action trong keyboard, textField...
    Ẩn bàn phím khi thực hiện action. Ẩn khi ấn ra ngoài.
link chi tiết: https://github.com/dangduycuong/MasterSearch

override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(true)

	// Ẩn bàn phím khi ấn ra bên ngoài
        let tapGestureReconizer = UITapGestureRecognizer(target: self, action: #selector(dismissKeyboard))
        tapGestureReconizer.cancelsTouchesInView = false
        view.addGestureRecognizer(tapGestureReconizer)
    }
    
    @objc func dismissKeyboard() {
        view.endEditing(true)
    }


====
	//Giới hạn số ký tự nhập vào searchBar

    func searchBar(_ searchBar: UISearchBar, textDidChange searchText: String) {
        if searchBar.text!.length() > 16 {
            var searchText = searchBar.text!
            let range = searchText.index(searchText.startIndex, offsetBy: 16)..<searchText.endIndex
            searchText.removeSubrange(range)
            searchBar.text = searchText
        }
    }





====Trim Space
    var trimSpace = "  Let's trim all the whitespace  "
    
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        let trimmedString = trimSpace.trimmingCharacters(in: .whitespacesAndNewlines)
        print(trimmedString)

	//result: Let's trim all the whitespace
    }








====full màn hình khi chuyển màn trong iOS 13.2
    @IBAction func nextVCAction(_ sender: UIButton) {
        
//        present(vc!, animated: true, completion: nil)
//
//        let vc = UIViewController()
//        let vc = DetailVC()
        let vc = storyboard?.instantiateViewController(identifier: "DetailVC") as? DetailVC
        vc?.modalPresentationStyle = .fullScreen //or .overFullScreen for transparency
        self.present(vc!, animated: true, completion: nil)
    }



====LoadMore
func scrollViewDidEndDecelerating(_ scrollView: UIScrollView) {
        if self.stopLoadMore {
            return
        }
        let endScrolling = scrollView.contentOffset.y + scrollView.frame.size.height
        if endScrolling >= scrollView.contentSize.height - 30 && endScrolling <= scrollView.contentSize.height + 30 {
            self.pageIndex += 1
            self.getListCableLane(laneCode: self.searchTextField.text ?? "")
//            if self.isBTSStation {
//                self.getListCableLane(laneCode: self.searchTextField.text ?? "")
//            } else {
//
//            }
        }
    }
====Lấy toạ độ 4 góc của màn hình trong google map
    func mapView(_ mapView: GMSMapView, didChange position: GMSCameraPosition) {
        let projection = mapView.projection.visibleRegion()

        let topLeftCorner: CLLocationCoordinate2D = projection.farLeft
        let topRightCorner: CLLocationCoordinate2D = projection.farRight
        let bottomLeftCorner: CLLocationCoordinate2D = projection.nearLeft
        let bottomRightCorner: CLLocationCoordinate2D = projection.nearRight
        print("Toạ độ: ", topLeftCorner, topRightCorner, bottomLeftCorner, bottomRightCorner)
    }

====Vừa nhập vừa lọc trên textField
searchBarTextField.addTarget(self, action: #selector(searchRecords), for: .editingChanged)


====Action trên marker google map
func mapView(_ mapView: GMSMapView, didTap marker: GMSMarker) -> Bool {
	print("chạm vào marker", marker.title as Any)
        apiType = .findByMapFrame
        setValueParams()
        findByMapFrame(params: params)
        return true
}




====lấy index trên marker
mảng để marker: listStation
mảng để quản lý marker: var markers = [GMSMarker]()
trong func marker append marker vào markers:
    //Đánh dấu các nhà trạm trên map
    func loadListCritialPointsToMap() {
	markers.removeAll()
        for i in 0..<listStation.count {
            if let lat = listStation[i].latitude, let lng = listStation[i].longtitude {
                let marker = GMSMarker()
                marker.position = CLLocationCoordinate2D(latitude: lat, longitude: lng)
                marker.title = listStation[i].address
                marker.icon = GMSMarker.markerImage(with: UIColor.gray)
                
                markers.append(marker) //append marker to markers to manager
                
                marker.map = viewMap
            }
        }
    }

//Action when tapped in to marker (only marker). Get index of listStation
    func mapView(_ mapView: GMSMapView, didTap marker: GMSMarker) -> Bool {
        print("chạm vào marker", marker.title as Any)
        
        if let index = markers.index(of: marker) {
            let tappedStation = listStation[index]
            diaChiTextField.text = tappedStation.address
            chuTramTextField.text = tappedStation.houseOwnerName
            sdtChuTramTextField.text = tappedStation.houseOwnerPhone
        }
        
        popupView.isHidden = false
        
        apiType = .findByMapFrame
        setValueParams()
        findByMapFrame(params: params)
        return true
    }


====tỉ lệ layout trong code
extension NSLayoutConstraint {
    func constraintWithMultiplier(_ multiplier: CGFloat) -> NSLayoutConstraint {
        return NSLayoutConstraint(item: self.firstItem!, attribute: self.firstAttribute, relatedBy: self.relation, toItem: self.secondItem, attribute: self.secondAttribute, multiplier: multiplier, constant: self.constant)
    }
}

Usage:

let newConstraint = constraintToChange.constraintWithMultiplier(0.75)
view.removeConstraint(constraintToChange)
view.addConstraint(newConstraint)
view.layoutIfNeeded()
constraintToChange = newConstraint

====Sắp xếp theo alpha b
let names = ["A", "B", "C", "E", "D"]

func backward(_ s1: String, _ s2: String) -> Bool {
    return s1 < s2
}
var reversedNames = names.sorted(by: backward)

====Action textfield
    @IBAction func buttonSearch(_ sender: Any) {
	
    }

	func textFieldShouldReturn(_ textField: UITextField) -> Bool {
        	self.buttonSearch(self)
        	return true
    	}

====show/hide keyboard by button
show:
textField.becomeFirstResponder()
hide:
textField.resignFirstResponder()


====delegate qua BaseTableViewCell
    @IBAction func tappedEditAddress(_ sender: UIButton) {
        diaChiView.isHidden = true
        addressTextField.becomeFirstResponder()
        if let delegate = self.delegate as? BTS360TongQuanCellDelegate {
            params["address"] = addressTextField.text
            params["houseOwnerName"] = houseOwnerNameTextField.text
            params["houseOwnerPhone"] = houseOwnerPhoneTextField.text
            delegate.isUpdate(isUpdate: true, params: params)
        }
    }

====Lấy toạ độ 4 góc màn hình khi vừa loadMap
var viewMap: GMSMapView?
let projection = viewMap?.projection.visibleRegion()
let topLeftCorner: CLLocationCoordinate2D = projection!.farLeft
        let topRightCorner: CLLocationCoordinate2D = projection!.farRight
        let bottomLeftCorner: CLLocationCoordinate2D = projection!.nearLeft
        let bootomRightCorner: CLLocationCoordinate2D = projection!.nearRight

====bo tròn 1 góc nào đó của uiview
extension UIView {

  func roundCorners(_ corners: CACornerMask, radius: CGFloat, borderColor: UIColor, borderWidth: CGFloat) {
      self.layer.maskedCorners = corners
      self.layer.cornerRadius = radius
      self.layer.borderWidth = borderWidth
      self.layer.borderColor = borderColor.cgColor

  }

}
sử dụng: self.yourView.roundCorners([.layerMaxXMaxYCorner, .layerMaxXMinYCorner], radius: 20.0, borderColor: UIColor.red, borderWidth: 1)
====
func mapView(_ mapView: GMSMapView, didChange position: GMSCameraPosition) {
    let latitude = mapView.camera.target.latitude
    let longitude = mapView.camera.target.longitude
    centerMapCoordinate = CLLocationCoordinate2D(latitude: latitude, longitude: longitude)
    self.placeMarkerOnCenter(centerMapCoordinate:centerMapCoordinate)
}

Function to place a marker on center point

func placeMarkerOnCenter(centerMapCoordinate:CLLocationCoordinate2D) {
    let marker = GMSMarker()
    marker.position = centerMapCoordinate
    marker.map = self.mapView
}

====How to pass data from ViewController to a ViewController in a tab bar
override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
    let barViewControllers = segue.destination as! UITabBarController
    let destinationViewController = barViewControllers.viewControllers?[0] as! FirstViewController
    destinationViewController.test = "Hello TabBar 1"

    // access the second tab bar
    let secondDes = barViewControllers.viewControllers?[1] as! SecondViewController
    secondDes.test = "Hello TabBar 2"
}


====
3 màn:
màn 1: navigation controller
màn 2: viewcontroller
màn 3: viewcontroller

passdata from màn 3 về màn 2 khi ấn vào nút back button trên thanh navigation
Using UINavigationControllerDelegate:

class DetailsViewController: UIViewController, UINavigationControllerDelegate {
                                                        //     ^
    var data: [String] = []                             // Important!

    override func viewDidLoad() {
        super.viewDidLoad()

        navigationController?.delegate = self

        data = ["data has changed!"]
    }
}

Swift 2:

extension DetailsViewController: UINavigationControllerDelegate {
    func navigationController(navigationController: UINavigationController, willShowViewController viewController: UIViewController, animated: Bool) {
        if let controller = viewController as? ProgressTableViewController {
            controller.data = data    // Here you pass the data back to your original view controller
        }
    }
}

Swift 3:

extension DetailsViewController: UINavigationControllerDelegate {
    func navigationController(_ navigationController: UINavigationController, willShow viewController: UIViewController, animated: Bool) {
        (viewController as? ProgressTableViewController)?.data = data // Here you pass the to your original view controller
    }
}

swift 4
func navigationController(_ navigationController: UINavigationController, willShow viewController: UIViewController, animated: Bool) {
        (viewController as? TraCuuHaTangNimsVC)?.fromTongHopNims = false
    }
====
//MARK: Long Press
    func tableView(_ tableView: UITableView, willDisplay cell: UITableViewCell, forRowAt indexPath: IndexPath) {
        guard isSelectedButton == .truyen_dan && isLeftOptionSelected == false else { return }
        self.setupLongPressGesture()
    }
    
    func setupLongPressGesture() {
        let longPressGesture: UILongPressGestureRecognizer = UILongPressGestureRecognizer(target: self, action: #selector(self.handleLongPress))
            longPressGesture.minimumPressDuration = 0.8 //second press
            longPressGesture.delegate = self
            self.tableView.addGestureRecognizer(longPressGesture)
    }
    
    @objc func handleLongPress(_ gestureRecognizer: UILongPressGestureRecognizer) {
        if gestureRecognizer.state == .ended {
            let touchPoint = gestureRecognizer.location(in: self.tableView)
            let indexPath = tableView.indexPathForRow(at: touchPoint)
            self.indexPath = indexPath
//            self.oldTelFax = self.lstInfoTelForSub?[indexPath!.row].telFax ?? ""
            self.tableView.deselectRow(at: indexPath!, animated: true)
            let alert = UIAlertController(title: "Thông báo".language(), message: "Bạn muốn cập nhật loại ODF", preferredStyle: .alert)
            alert.addAction(UIAlertAction(title: "KHÔNG".language(), style: .default, handler: nil))
            alert.addAction(UIAlertAction(title: "CÓ".language(), style: .default, handler: { (alertAction) in
                self.title = ""
                let vc = Storyboard.QuanLyHaTangNIMS.nimsCapNhatLoaiODFVC()
                self.navigationController?.pushViewController(vc, animated: true)
            }))
            self.present(alert, animated: true, completion: nil)
        }
    }







====action khi chạm vào polyline
polyline.isTappable = true

Whenever the polyline is tapped, the GMSMapViewDelegate method didTapOverlay is called

func mapView(_ mapView: GMSMapView, didTap overlay: GMSOverlay) {
        //Write your code here
    }



====vuốt sau đó dừng sẽ chạy vào func này:
// stoped scroll google map
    func mapView(_ mapView: GMSMapView, idleAt position: GMSCameraPosition) {
        if callByMapFrameDefault {
            callAPIWhenStopScrollMap()
        }
        switch fromVC {
        case .OtherVC:
            // chạy lần 1 để đổi giá trị. Không gọi api khi vừa vào màn này, gọi khi vuốt bản đồ.
            callByMapFrameDefault = true
        default:
            callAPIWhenStopScrollMap()
        }
    }












